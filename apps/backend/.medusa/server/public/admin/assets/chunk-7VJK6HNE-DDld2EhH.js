import{D as q}from"./chunk-YEDAFXMB-DSZvk7zJ.js";import{D as X}from"./chunk-AOFGTNG6-CDM44hkC.js";import{N as Y,a as Z}from"./chunk-EMIHDNB7-SccrBMEV.js";import{D as G}from"./chunk-Z26G6WFJ-DnGjRuyC.js";import{ae as _,r as m,bI as ee,bJ as te,bK as se,bL as ae,j as e,bM as le,M as b,b as U,bN as J,L as oe}from"./index-BpfPnGdZ.js";import{T as R}from"./table-DW79ophy.js";import{C as D}from"./command-bar-CZwuJqwH.js";var ne=({search:s,orderBy:l,filters:i,prefix:n})=>(s||l||i||n)&&e.jsxs("div",{className:"flex items-start justify-between gap-x-4 px-6 py-4",children:[e.jsx("div",{className:"w-full max-w-[60%]",children:i&&i.length>0&&e.jsx(G,{filters:i,prefix:n})}),e.jsxs("div",{className:"flex shrink-0 items-center gap-x-2",children:[s&&e.jsx(q,{prefix:n,autofocus:s==="autofocus"}),l&&e.jsx(X,{keys:l,prefix:n})]})]}),re=({table:s,columns:l,pagination:i,navigateTo:n,commands:o,count:j=0,noResults:k=!1,noHeader:r=!1,layout:c="fit"})=>{const{t:M}=U(),[P,N]=m.useState(!1),w=m.useRef(null),x=l.find(t=>t.id==="select"),d=l.find(t=>t.id==="actions"),p=o&&o.length>0,g=s.getState().rowSelection,{pageIndex:S,pageSize:T}=s.getState().pagination,O=100/(l.length-(x?1:0)-(d?1:0)),E=t=>{t.currentTarget.scrollLeft>0?N(!0):N(!1)},A=async t=>{await t(g).then(()=>{s.resetRowSelection()})};return m.useEffect(()=>{var t;(t=w.current)==null||t.scroll({top:0,left:0})},[S]),e.jsxs("div",{className:b("flex w-full flex-col overflow-hidden",{"flex flex-1 flex-col":c==="fill"}),children:[e.jsx("div",{ref:w,onScroll:E,className:b("w-full",{"min-h-0 flex-grow overflow-auto":c==="fill","overflow-x-auto":c==="fit"}),children:k?e.jsx("div",{className:b({"border-b":c==="fit"}),children:e.jsx(Z,{})}):e.jsxs(R,{className:"relative w-full",children:[!r&&e.jsx(R.Header,{className:"border-t-0",children:s.getHeaderGroups().map(t=>e.jsx(R.Row,{className:b({"relative border-b-0 [&_th:last-of-type]:w-[1%] [&_th:last-of-type]:whitespace-nowrap":d,"[&_th:first-of-type]:w-[1%] [&_th:first-of-type]:whitespace-nowrap":x}),children:t.headers.map((a,H)=>{const v=a.id==="actions",f=a.id==="select",u=v||f,y=t.headers.findIndex(L=>L.id!=="select"),C=y!==-1?a.id===t.headers[y].id:H===0,h=f||C;return e.jsx(R.HeaderCell,{"data-table-header-id":a.id,style:{width:u?void 0:`${O}%`},className:b({"bg-ui-bg-subtle sticky left-0 after:absolute after:inset-y-0 after:right-0 after:h-full after:w-px after:bg-transparent after:content-['']":h,"left-[68px]":h&&x&&!f,"after:bg-ui-border-base":P&&h&&!u}),children:J(a.column.columnDef.header,a.getContext())},a.id)})},t.id))}),e.jsx(R.Body,{className:"border-b-0",children:s.getRowModel().rows.map(t=>{const a=n?n(t):void 0,H=x&&!t.getCanSelect(),v=t.depth%2!==0,f=t.getVisibleCells();return e.jsx(R.Row,{"data-selected":t.getIsSelected(),className:b("transition-fg group/row group relative [&_td:last-of-type]:w-[1%] [&_td:last-of-type]:whitespace-nowrap","has-[[data-row-link]:focus-visible]:bg-ui-bg-base-hover",{"bg-ui-bg-subtle hover:bg-ui-bg-subtle-hover":v,"cursor-pointer":!!a,"bg-ui-bg-highlight hover:bg-ui-bg-highlight-hover":t.getIsSelected(),"!bg-ui-bg-disabled !hover:bg-ui-bg-disabled":H}),children:f.map((u,y)=>{const C=t.getVisibleCells(),h=u.column.id==="select",L=C.findIndex(W=>W.column.id!=="select"),F=L!==-1?u.column.id===C[L].column.id:y===0,z=h||F,$=t.depth>0&&F?t.depth*14+24:void 0,Q=z&&x&&!h,V=J(u.column.columnDef.cell,u.getContext()),B=F&&!!a,K=!!a&&!h;return e.jsx(R.Cell,{className:b({"!pl-0 !pr-0":K,"bg-ui-bg-base group-data-[selected=true]/row:bg-ui-bg-highlight group-data-[selected=true]/row:group-hover/row:bg-ui-bg-highlight-hover group-hover/row:bg-ui-bg-base-hover transition-fg group-has-[[data-row-link]:focus-visible]:bg-ui-bg-base-hover sticky left-0 after:absolute after:inset-y-0 after:right-0 after:h-full after:w-px after:bg-transparent after:content-['']":z,"bg-ui-bg-subtle group-hover/row:bg-ui-bg-subtle-hover":v&&z,"left-[68px]":Q,"after:bg-ui-border-base":P&&z&&!h,"!bg-ui-bg-disabled !hover:bg-ui-bg-disabled":H}),style:{paddingLeft:$?`${$}px`:void 0},children:K?e.jsx(oe,{to:a,className:"size-full outline-none","data-row-link":!0,tabIndex:B?0:-1,children:e.jsx("div",{className:b("flex size-full items-center pr-6",{"pl-6":B&&!Q}),children:V})}):V},u.id)})},t.id)})})]})}),i&&e.jsx("div",{className:b({"border-t":c==="fill"}),children:e.jsx(ie,{canNextPage:s.getCanNextPage(),canPreviousPage:s.getCanPreviousPage(),nextPage:s.nextPage,previousPage:s.previousPage,count:j,pageIndex:S,pageCount:s.getPageCount(),pageSize:T})}),p&&e.jsx(D,{open:!!Object.keys(g).length,children:e.jsxs(D.Bar,{children:[e.jsx(D.Value,{children:M("general.countSelected",{count:Object.keys(g).length})}),e.jsx(D.Seperator,{}),o==null?void 0:o.map((t,a)=>e.jsxs(m.Fragment,{children:[e.jsx(D.Command,{label:t.label,shortcut:t.shortcut,action:()=>A(t.action)}),a<o.length-1&&e.jsx(D.Seperator,{})]},a))]})})]})},ie=s=>{const{t:l}=U(),i={of:l("general.of"),results:l("general.results"),pages:l("general.pages"),prev:l("general.prev"),next:l("general.next")};return e.jsx(R.Pagination,{className:"flex-shrink-0",...s,translations:i})},ce=m.memo(ne),pe=({table:s,columns:l,pagination:i,navigateTo:n,commands:o,count:j=0,search:k=!1,orderBy:r,filters:c,prefix:M,queryObject:P={},pageSize:N,isLoading:w=!1,noHeader:x=!1,layout:d="fit",noRecords:p={}})=>{if(w)return e.jsx(le,{layout:d,rowCount:N,search:!!k,filters:!!(c!=null&&c.length),orderBy:!!(r!=null&&r.length),pagination:!!i});const g=Object.values(P).filter(I=>!!I).length===0,S=!w&&j===0&&!g;return!w&&j===0&&g?e.jsx(Y,{className:b({"flex h-full flex-col overflow-hidden":d==="fill"}),...p}):e.jsxs("div",{className:b("divide-y",{"flex h-full flex-col overflow-hidden":d==="fill"}),children:[e.jsx(ce,{search:k,orderBy:r,filters:c,prefix:M}),e.jsx(re,{table:s,count:j,columns:l,pagination:!0,navigateTo:n,commands:o,noResults:S,noHeader:x,layout:d})]})},ve=({data:s=[],columns:l,count:i=0,pageSize:n=20,enablePagination:o=!0,enableRowSelection:j=!1,enableExpandableRows:k=!1,rowSelection:r,getSubRows:c,getRowId:M,meta:P,prefix:N})=>{const[w,x]=_(),d=`${N?`${N}_`:""}offset`,p=w.get(d),[{pageIndex:g,pageSize:S},T]=m.useState({pageIndex:p?Math.ceil(Number(p)/n):0,pageSize:n}),I=m.useMemo(()=>({pageIndex:g,pageSize:S}),[g,S]),[O,E]=m.useState({}),A=(r==null?void 0:r.state)??O,t=(r==null?void 0:r.updater)??E;m.useEffect(()=>{if(!o)return;const v=p?Math.ceil(Number(p)/n):0;v!==g&&T(f=>({...f,pageIndex:v}))},[p,o,n,g]);const a=v=>{const f=v(I),{pageIndex:u,pageSize:y}=f;return x(C=>{if(!u)return C.delete(d),C;const h=new URLSearchParams(C);return h.set(d,String(u*y)),h}),T(f),f};return{table:ee({data:s,columns:l,state:{rowSelection:A,pagination:o?I:void 0},pageCount:Math.ceil((i??0)/S),enableRowSelection:j,getRowId:M,getSubRows:c,onRowSelectionChange:j?t:void 0,onPaginationChange:o?a:void 0,getCoreRowModel:ae(),getPaginationRowModel:o?se():void 0,getExpandedRowModel:k?te():void 0,manualPagination:o?!0:void 0,meta:P})}};export{pe as _,ve as u};
