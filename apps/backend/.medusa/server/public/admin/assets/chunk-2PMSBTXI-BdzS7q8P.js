import{r as s,b as re,c_ as ie,j as t,c$ as oe,M as c,U as p,d0 as ne,d1 as le,d2 as ce,d3 as _,d4 as de,b$ as ue,ay as be,d5 as me,d6 as fe}from"./index-BpfPnGdZ.js";import{X as W}from"./x-mark-mini-hOCHhWa9.js";import{T as xe}from"./triangles-mini-MGL63xRf.js";import{P as pe}from"./plus-mini-DwCGy8dy.js";function ge(o){return s.forwardRef(o)}var $=8,B=28,he=({value:o,onChange:w,searchValue:g,onSearchValueChange:S,options:n,className:L,placeholder:X,fetchNextPage:f,isFetchingNextPage:h,onCreateOption:v,noResultsPlaceholder:T,allowClear:F,...G},J)=>{var U;const[d,M]=s.useState(!1),[K,Q]=s.useTransition(),{t:j}=re(),I=s.useRef(null),V=s.useRef(null);s.useImperativeHandle(J,()=>I.current);const R=o!==void 0,u=g!==void 0,l=Array.isArray(o),k=l?[]:"",[x,y]=s.useState(g||""),A=s.useDeferredValue(x),[Y,Z]=s.useState(k),b=u?g:x,a=R?o:Y,C=e=>{!n.filter(i=>!i.disabled).find(i=>l?e==null?void 0:e.includes(i.value):i.value===e)&&v&&e&&v(e),R||Z(e||k),w&&w(e),y("")},q=e=>{y(e),S&&S(e)},O=s.useMemo(()=>u?[]:ie(n,A,{keys:["label"]}),[n,A,u]),N=s.useRef(new IntersectionObserver(e=>{e[0].isIntersecting&&(f==null||f())},{threshold:1})),P=s.useCallback(e=>{h||(N.current&&N.current.disconnect(),e&&N.current.observe(e))},[h]),ee=e=>{e||y(""),M(e)},D=(a==null?void 0:a.length)>0,r=D&&l,E=r&&!b&&!d,H=!l&&D&&!d,te=(U=n.find(e=>e.value===a))==null?void 0:U.label,se=E||d,ae=s.useMemo(()=>{if(!Array.isArray(a))return B+$;const m=a.length.toString().length;return B+m*$},[a]),z=s.useMemo(()=>u?n:O,[O,n,u]);return t.jsxs(oe,{open:d,setOpen:ee,selectedValue:a,setSelectedValue:e=>C(e),value:x,setValue:e=>{Q(()=>q(e))},children:[t.jsxs("div",{className:c("relative flex cursor-pointer items-center gap-x-2 overflow-hidden","h-8 w-full rounded-md","bg-ui-bg-field transition-fg shadow-borders-base","has-[input:focus]:shadow-borders-interactive-with-active","has-[:invalid]:shadow-borders-error has-[[aria-invalid=true]]:shadow-borders-error","has-[:disabled]:bg-ui-bg-disabled has-[:disabled]:text-ui-fg-disabled has-[:disabled]:cursor-not-allowed",L),style:{"--tag-width":`${ae}px`},children:[r&&t.jsxs("button",{type:"button",onClick:e=>{e.preventDefault(),C(l?[]:void 0)},className:"bg-ui-bg-base hover:bg-ui-bg-base-hover txt-compact-small-plus text-ui-fg-subtle focus-within:border-ui-fg-interactive transition-fg absolute left-0.5 top-0.5 z-[1] flex h-[28px] items-center rounded-[4px] border py-[3px] pl-1.5 pr-1 outline-none",children:[t.jsx("span",{className:"tabular-nums",children:a.length}),t.jsx(W,{className:"text-ui-fg-muted"})]}),t.jsxs("div",{className:"relative flex size-full items-center",children:[E&&t.jsx("div",{className:c("pointer-events-none absolute inset-y-0 flex size-full items-center",{"left-[calc(var(--tag-width)+8px)]":r,"left-2":!r}),children:t.jsx(p,{size:"small",leading:"compact",children:j("general.selected")})}),H&&t.jsx("div",{className:c("pointer-events-none absolute inset-y-0 flex size-full items-center overflow-hidden",{"left-[calc(var(--tag-width)+8px)]":r,"left-2":!r}),children:t.jsx(p,{size:"small",leading:"compact",className:"truncate",children:te})}),t.jsx(ne,{autoSelect:!0,ref:I,onFocus:()=>M(!0),className:c("txt-compact-small text-ui-fg-base !placeholder:text-ui-fg-muted transition-fg size-full cursor-pointer bg-transparent pl-2 pr-8 outline-none focus:cursor-text","hover:bg-ui-bg-field-hover",{"opacity-0":H,"pl-2":!r,"pl-[calc(var(--tag-width)+8px)]":r}),placeholder:se?void 0:X,...G})]}),F&&o&&t.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),C(void 0)},className:"bg-ui-bg-base hover:bg-ui-bg-base-hover txt-compact-small-plus text-ui-fg-subtle focus-within:border-ui-fg-interactive transition-fg absolute right-[28px] top-0.5 z-[1] flex h-[28px] items-center rounded-[4px] border px-1.5 py-[2px] outline-none",children:t.jsx(W,{className:"text-ui-fg-muted"})}),t.jsx(le,{render:e=>t.jsx("button",{...e,type:"button",className:"text-ui-fg-muted transition-fg hover:bg-ui-bg-field-hover absolute right-0 flex size-8 items-center justify-center rounded-r outline-none",children:t.jsx(xe,{})})})]}),t.jsxs(ce,{gutter:4,sameWidth:!0,ref:V,role:"listbox",className:c("shadow-elevation-flyout bg-ui-bg-base z-50 rounded-[8px] p-1","max-h-[200px] overflow-y-auto","data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95","data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95","data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2"),style:{pointerEvents:d?"auto":"none"},"aria-busy":K,children:[z.map(({value:e,label:m,disabled:i})=>t.jsxs(_,{value:e,focusOnHover:!0,setValueOnClick:!1,disabled:i,className:c("transition-fg bg-ui-bg-base data-[active-item=true]:bg-ui-bg-base-hover group flex cursor-pointer items-center gap-x-2 rounded-[4px] px-2 py-1",{"text-ui-fg-disabled":i,"bg-ui-bg-component":i}),children:[t.jsx(de,{className:"flex !size-5 items-center justify-center",children:l?t.jsx(ue,{}):t.jsx(be,{})}),t.jsx(me,{className:"txt-compact-small",children:m})]},e)),!!f&&t.jsx("div",{ref:P,className:"w-px"}),h&&t.jsx("div",{className:"transition-fg bg-ui-bg-base flex items-center rounded-[4px] px-2 py-1.5",children:t.jsx("div",{className:"bg-ui-bg-component size-full h-5 w-full animate-pulse rounded-[4px]"})}),!z.length&&(T&&!(b!=null&&b.length)?T:t.jsx("div",{className:"flex items-center gap-x-2 rounded-[4px] px-2 py-1.5",children:t.jsx(p,{size:"small",leading:"compact",className:"text-ui-fg-subtle",children:j("general.noResultsTitle")})})),!z.length&&v&&t.jsxs(s.Fragment,{children:[t.jsx(fe,{className:"bg-ui-border-base -mx-1"}),t.jsxs(_,{value:x,focusOnHover:!0,setValueOnClick:!1,className:"transition-fg bg-ui-bg-base data-[active-item=true]:bg-ui-bg-base-hover group mt-1 flex cursor-pointer items-center gap-x-2 rounded-[4px] px-2 py-1.5",children:[t.jsx(pe,{className:"text-ui-fg-subtle"}),t.jsxs(p,{size:"small",leading:"compact",children:[j("actions.create"),' "',b,'"']})]})]})]})]})},Ne=ge(he);export{Ne as C};
